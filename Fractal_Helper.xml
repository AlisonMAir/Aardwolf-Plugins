<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Sunday, March 05, 2023, 4:02 PM -->
<!-- MuClient version 5.07-pre -->

<!-- Plugin "Fractal_Helper" generated by Plugin Wizard -->

<muclient>
<plugin
   name="Fractal_Helper"
   author="Alison"
   id="c1584e5fe8e5fcea43ad4a60"
   language="Lua"
   purpose="Useful aliases and scripts for the Fractals of the Weave event."
   save_state="y"
   date_written="2023-03-05 15:56:56"
   requires="5.07"
   version="1.0"
   >
<description trim="y">
<![CDATA[
This plugin gags messages showing you others players moving, scanning, and fleeing/retreating as long as you're in the Fractals of the Weave area. 

Commands:

frac - This executes the commands "nod;unkeep frac;give frac frac". Use it to claim your reward when the Anomaly is dead.

fractal gagflee on/off - When on, flee/retreat messages will be gagged in Fractals. When off, they will no longer be gagged. This is a useful toggle if you want to gag scan/move messages, but not flee/retreat messages because you rely on seeing other players fleeing/retreating to know when to do so yourself.
]]>
</description>

</plugin>


<!--  Triggers  -->

<triggers>
  <trigger
   enabled="y"
   group="fractalgag"
   match="^(.*) (walks|runs|leaves|canters|gallops|crashes|dashes|zooms|flies|swoops|glides|darts|flits|slinks|marches|pads|scurries|scampers|skulks|slithers|sloshes|stomps|strides|jets|screams and charges)( in.*)? (north|south|east|west|up|down).$"
   omit_from_output="y"
   regexp="y"
   sequence="100"
  >
  </trigger>
  <trigger
  enabled="y"
  group="fractalgag"
  match="* has arrived through an abyssal portal."
  omit_from_output="y"
  sequence="100"
  >
  </trigger>
  <trigger
  enabled="y"
  group="fractalgag"
  match="* arrives from the *."
  omit_from_output="y"
  sequence="100"
  >
  </trigger>
  <trigger
  enabled="y"
  group="fractalgag"
  match="* considers * chances of taking on the whole room!"
  omit_from_output="y"
  sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="fractalgag"
   match="* scans * looking for lifesigns."
   omit_from_output="y"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="fractalgag"
   match="* scans all directions, looking for signs of life."
   omit_from_output="y"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="fractalgagflee"
   match="* has fled!"
   omit_from_output="y"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   group="fractalgagflee"
   match="* retreated from the fight!"
   omit_from_output="y"
   sequence="100"
  >
  </trigger>
</triggers>

<!--  Aliases  -->

<aliases>
  <alias
   match="frac"
   enabled="y"
   sequence="100"
  >
  <send>*nod
unkeep frac
give frac frac</send>
  </alias>
  <alias
   match="fractal gagflee off"
   enabled="y"
   send_to="12"
   sequence="100"
  >
  <send>SetVariable("fractal_gag_flee", "off")
SendNoEcho("echo @W(@MFractal@W) Flee and retreat messages in Fractal will no longer be gagged.@w")</send>
  </alias>
  <alias
   match="fractal gagflee on"
   enabled="y"
   send_to="12"
   sequence="100"
  >
  <send>SetVariable("fractal_gag_flee", "on")
SendNoEcho("echo @W(@MFractal@W) Flee and retreat messages in Fractal will now be gagged.@w")</send>
  </alias>
</aliases>

<!--  Variables  -->

<variables>
  <variable name="fractal_gag_flee">on</variable>
</variables>

<!--  Plugin help  -->

<aliases>
  <alias
   script="OnHelp"
   match="fractal help helper"
   enabled="y"
  >
  </alias>
</aliases>

<script>
<![CDATA[
function OnHelp ()
  world.Note (world.GetPluginInfo (world.GetPluginID (), 3))
end

function OnPluginInstall ()
	OnHelp()
end	

require "gmcphelper" 
function OnPluginBroadcast(msg, id, name, text)
	if id == "3e7dedbe37e44942dd46d264" then
		if (text == "room.info") then
			currentArea = gmcp("room.info.zone")
			gagFlee = GetVariable("fractal_gag_flee")
			if currentArea == "fractals" or currentArea == "fractal" then
				if gagFlee == "on" then
				EnableTriggerGroup("fractalgagflee", true)
				EnableTriggerGroup("fractalgag", true)
				
				elseif gagFlee == "off" then
				EnableTriggerGroup("fractalgag", true)
				EnableTriggerGroup("fractalgagflee", false)
				
				else
				SendNoEcho("echo @W(@MFractal@W) Something has gone very wrong with testing whether or not gagFlee is on or off. Please send a tell or note to Alison with this message.@w")
				end
				
			else
			EnableTriggerGroup("fractalgag", false)
			EnableTriggerGroup("fractalgagflee", false)
			end
		end
	end
end
]]>
</script> 

</muclient>
