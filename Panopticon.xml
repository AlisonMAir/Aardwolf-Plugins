<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Sunday, March 05, 2023, 11:43 AM -->
<!-- MuClient version 5.07-pre -->

<!-- Plugin "Panopticon" generated by Plugin Wizard -->

<muclient>
<plugin
   name="Panopticon"
   author="Alison"
   id="aa8f1bcf7b7b3fa483ffe7e5"
   language="Lua"
   purpose="Helps you scan for your PK target, and stops when it finds them."
   save_state="y"
   date_written="2023-03-05 11:30:54"
   requires="5.07"
   version="1.0"
   >
<description trim="y">
<![CDATA[
This plugin helps you scan for your PK target, and stops when it finds them. You can stand outside an area and use it to see when they enter and chase them inside.

The "rs" command will try to initiate combat with one of the curse scrolls from the Shadokil shop (run ede from recall). Make sure to have a few copies of both scrolls in your inventory if you intend to use it.

Commands: 

pkt <name> - Set your PK target to <name>.

rs (short for "recite secrets") - Initiate combat with a curse scroll on your PK target.

panop - Scan for your PK target. Will stop when it sees them, or when it has scanned 100 times unsuccessfully. (In that case, you have to use panop again to keep scanning.)

If the script bugs out and keeps scanning over and over, you should be able to stop it by using "rs" or the special command "panopticonEnded". Send a tell or note to me describing the bug if this occurs.

LEGALITY DISCLAIMER: Like SnD, this script is legal but is easy to make illegal. If you modify it too much, you might run into trouble with the imms. If you make the script continue going even after 100 failed scans, and you go afk while using it, you are spamming the MUD, which is illegal. If you automatically move upon detecting the player, you are providing them with a method of remote control, which is illegal. If you automatically attack the player upon detecting them, you are straight up botting, which is, of course, illegal. Use responsibly!
]]>
</description>

</plugin>


<!--  Triggers  -->

<triggers>
  <trigger
   enabled="y"
   match="* from here you see:"
   send_to="12"
   sequence="100"
  >
  <send>EnableTrigger("scanTrigger", false)</send>
  </trigger>
  <trigger
   back_colour="8"
   expand_variables="y"
   match="Nothing to see around here with that name."
   match_back_colour="y"
   name="scanTrigger"
   send_to="12"
   sequence="100"
  >
  <send>timesScanned = tonumber(GetVariable("timesScanned"))

world.Execute("scan @pk_target")
SetVariable("timesScanned", timesScanned + 1)

if (timesScanned &gt; 100) then
   world.Execute("panopticonEnded")
   EnableTrigger("scanTrigger", false)
end</send>
  </trigger>
</triggers>

<!--  Aliases  -->

<aliases>
  <alias
   match="panop"
   enabled="y"
   expand_variables="y"
   send_to="12"
   sequence="100"
  >
  <send>SetVariable("timesScanned", 1)
EnableTrigger("scanTrigger", true)
world.Execute("scan @pk_target")</send>
  </alias>
  
  <alias 
  match="pkt *"
  enabled="y"
  expand_variables="y"
  send_to="12"
  sequence="100"
  >
  <send>SetVariable("pk_target", "%1")
  SendNoEcho("echo @@WYour PK target has been changed to @@Y%1@@W.@@w")</send>
  </alias>
  
  <alias
   match="rs"
   enabled="y"
   expand_variables="y"
   send_to="12"
   sequence="100"
  >
  <send>require "gmcphelper"
myLevel = tonumber(gmcp("char.status.level"))
myTier = tonumber(gmcp("char.base.tier"))
adjLevel = myLevel + myTier * 10
classes = tonumber(gmcp("char.base.classes"))

EnableTrigger("scanTrigger", false)

if (string.find(classes, "0") == nil and string.find(classes, "1") == nil and string.find(classes, "2") == nil and string.find(classes, "6") == nil and adjLevel &lt; 201) then
Send("kill @pk_target")
elseif (adjLevel &gt;= 200) then
Send("recite whispers @pk_target")
elseif (adjLevel &gt;= 105) then
Send("recite secrets @pk_target")
end</send>
  </alias>
  <alias
   match="panopticonEnded"
   enabled="y"
   send_to="12"
   sequence="100"
  >
  <send>SendNoEcho("echo @WYour @Ysurveillance@W has ended.@w")</send>
  </alias>
</aliases>

<!--  Variables  -->

<variables>
  <variable name="pk_target"> </variable>
  <variable name="timesScanned">1</variable>
</variables>

<!--  Plugin help  -->

<aliases>
  <alias
   script="OnHelp"
   match="panop help"
   enabled="y"
  >
  </alias>
</aliases>

<script>
<![CDATA[
function OnHelp ()
  world.Note (world.GetPluginInfo (world.GetPluginID (), 3))
end
]]>
</script> 

</muclient>
